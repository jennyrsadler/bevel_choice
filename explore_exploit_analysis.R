library(psych)
library(Hmisc)

df <- read.table("/Users/jennygilbert/Documents/bevel_choice/combined_output.csv", sep=',', header= T)
names(df)

summary(df)

mytable <- table(df$ID, df$reinforcer_response)
df1 <- as.data.frame.matrix(mytable) 

bevel1 <- read.csv("/Users/jennygilbert/Google Drive/NIBL/Projects/18-0417 BeveL/data/clean_data/clean_bevel.csv")
names(bevel1)
bevel <- bevel1[-c(91,92,93), ]

bevel$exploit_punish <- df1$exploit_punish
bevel$exploit_reward <- df1$exploit_reward
bevel$explore_punish <- df1$explore_punish
bevel$explore_reward <- df1$explore_reward

bevel$explore_prop <- (bevel$explore_punish + bevel$explore_reward) / bevel$taste_reinforcers
bevel$exploit_prop <- (bevel$exploit_punish + bevel$exploit_reward) / bevel$taste_reinforcers
bevel$tradeoff <- (bevel$exploit_reward + bevel$exploit_punish) / (bevel$explore_reward + bevel$explore_reward)

hist(bevel$exploit_prop)
hist(bevel$explore_prop)
hist(bevel$tradeoff)

describe(bevel$exploit_prop)
describe(bevel$explore_prop)

describe(bevel$exploit_reward)
describe(bevel$explore_reward)
describe(bevel$exploit_punish)
describe(bevel$explore_punish)
describe(bevel$tradeoff)

hist(bevel$sensitivity_reward)
hist(bevel$sensitivity_punish)

bevelsubset <- data.frame(bevel$exploit_reward, bevel$exploit_punish, bevel$explore_reward, bevel$explore_punish, bevel$tradeoff, bevel$sensitivity_reward, bevel$sensitivity_punish,
                          bevel$BMI, bevel$nback_accuracy, bevel$SPSRQ_reward, bevel$SPSRQ_punishment, bevel$bis, bevel$bas, bevel$DRES)


res <- cor(bevelsubset, use = "complete.obs")
round(res, 2)
res2 <- rcorr(as.matrix(bevelsubset))
res2
res2$P

write.csv(res, "/Users/jennygilbert/Desktop/correlation.csv")
write.csv(res2$P, "/Users/jennygilbert/Desktop/correlation-p.csv")

reg <- lm(sensitivity_reward ~ exploit_reward + exploit_punish + explore_reward + explore_punish, data=bevel)
summary(reg)

reg <- lm(sensitivity_punish ~ exploit_reward + exploit_punish + explore_reward + explore_punish, data=bevel)
summary(reg)

reg <- lm(sensitivity_punish ~ exploit_punish, data=bevel)
summary(reg)

ggplot(bevel, aes(x = exploit_punish, y = sensitivity_punish)) + 
  geom_point() +
  stat_smooth(method = "lm", col = "red")


reg <- lm(tradeoff ~ BMI + nback_accuracy + SPSRQ_reward + SPSRQ_punishment + bis + bas + DRES, data=bevel)
summary(reg)

reg <- lm(exploit_reward ~ BMI + nback_accuracy + SPSRQ_reward + SPSRQ_punishment + bis + bas + DRES, data=bevel)
summary(reg)

reg <- lm(exploit_punish ~ BMI + nback_accuracy + SPSRQ_reward + SPSRQ_punishment + bis + bas + DRES, data=bevel)
summary(reg)

reg <- lm(explore_reward ~ BMI + nback_accuracy + SPSRQ_reward + SPSRQ_punishment + bis + bas + DRES, data=bevel)
summary(reg)

reg <- lm(explore_reward ~ SPSRQ_reward, data=bevel)
summary(reg)

ggplot(bevel, aes(x = SPSRQ_reward, y = explore_reward)) + 
  geom_point() +
  stat_smooth(method = "lm", col = "red")

reg <- lm(explore_punish ~ BMI + nback_accuracy + SPSRQ_reward + SPSRQ_punishment + bis + bas + DRES, data=bevel)
summary(reg)
